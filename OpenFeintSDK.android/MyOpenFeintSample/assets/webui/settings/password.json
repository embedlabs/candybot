{"title":"Change Password","scrolling":true,"loadflow":null,"init":"$('body').addClass('textured');\n$('#subheader').text(OF.page.title);\n$('#change_password_form').submit(function() {\n  if ($(this).isLoading()) return false;\n  \n  var oldPass = $('#password').val();\n  var newPass = $('#user_http_basic_credential_attributes_password').val();\n  var newPassConfirm = $('#user_http_basic_credential_attributes_password_confirmation').val();\n  \n  if ($('#change_password_form').isFormFilled('Please fill out all fields in order to change your password.')) {\n    $(this).isLoading(true);\n    OF.api.request('/xp/users/'+ OF.user.id, {\n      method: 'PUT',\n      loader: '#submit',\n      params: {\n        password: $('#password').val(),\n        user: {\n          http_basic_credential_attributes: {\n            password:               $('#user_http_basic_credential_attributes_password').val(),\n            password_confirmation:  $('#user_http_basic_credential_attributes_password_confirmation').val(),\n          }\n        }\n      },\n      success: function() {\n        OF.goBack();\n        OF.alert('Success', \"You have changed your password.\");\n      },\n      failure: function(data) {\n        if (data.exception) {\n          if (data.exception['class'] == 'PlayerNotAuthenticated') {\n            OF.alert('Error', 'Your current password was not correct.');\n          } else {\n            return false;\n          }\n        } else {\n          return false;\n        }\n      },\n      complete: function() {\n        $('#change_password_form').isLoading(false);\n      }\n    });\n  }\n  \n  return false;\n});\n\n$('#submit').touch(function() {\n  $('#change_password_form').submit();\n});","resume":null,"appear":null,"disappear":null,"exit":null,"html":"<div id='settings'>\n  <div id='header'>\n    Settings\n    <span class='loading'>\n      <span class='spinner'></span>\n    </span>\n  </div>\n  <div id='subheader'></div>\n  <form id='change_password_form'>\n    <div class='input_field'>\n      <label>Current Password</label>\n      <input id='password' name='password' type='password'>\n    </div>\n    <div class='input_field'>\n      <label>New Password</label>\n      <input id='user_http_basic_credential_attributes_password' name='user[http_basic_credential_attributes][password]' type='password'>\n    </div>\n    <div class='input_field'>\n      <label>Confirm Password</label>\n      <input id='user_http_basic_credential_attributes_password_confirmation' name='user[http_basic_credential_attributes][password_confirmation]' type='password'>\n    </div>\n    <div class='button' id='submit'>Okay</div>\n  </form>\n</div>\n"}