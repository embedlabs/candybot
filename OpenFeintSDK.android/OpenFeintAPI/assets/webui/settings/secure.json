{"title":"Enable Account Retrieval","scrolling":true,"loadflow":null,"init":"$('body').addClass('textured');\n$('#subheader').text(OF.page.title);\n$('#secure_account_form').submit(function() {\n  if ($(this).isLoading()) return false;\n\n  //var email = $('#email').val();\n  //var newPass = $('#user_http_basic_credential_attributes_password').val();\n  //var newPassConfirm = $('#user_http_basic_credential_attributes_password_confirmation').val();\n\n  if ($('#secure_account_form').isFormFilled('Please fill out all fields in order to enable retrieval of your account.')) {\n    $(this).isLoading(true);\n    OF.api.request('/xp/users/'+ OF.user.id, {\n      method: 'PUT',\n      loader: '#submit',\n      params: {\n        password: ' ',\n        user: {\n          http_basic_credential_attributes: {\n            email:                  $('#email').val(),\n            password:               $('#user_http_basic_credential_attributes_password').val(),\n            password_confirmation:  $('#user_http_basic_credential_attributes_password_confirmation').val()\n          }\n        }\n      },\n      success: function() {\n        OF.goBack();\n        OF.alert('Success', \"You have attached email and password to your account.\");\n      },\n      complete: function() {\n        $('#secure_account_form').isLoading(false);\n      }\n    });\n  }\n\n  return false;\n});\n\n$('#submit').touch(function() {\n  $('#secure_account_form').submit();\n});","resume":null,"appear":null,"disappear":null,"exit":null,"html":"<div id='settings'>\n  <div id='header'>\n    Settings\n    <span class='loading'>\n      <span class='spinner'></span>\n    </span>\n  </div>\n  <div id='subheader'></div>\n  <form id='secure_account_form'>\n    <p>\n      Attaching an email address and password to your account lets you log in from any device.\n    </p>\n    <div class='input_field'>\n      <label>Email</label>\n      <input id='email' name='email' type='text'>\n    </div>\n    <div class='input_field'>\n      <label>Password</label>\n      <input id='user_http_basic_credential_attributes_password' name='user[http_basic_credential_attributes][password]' type='password'>\n    </div>\n    <div class='input_field'>\n      <label>Confirm Password</label>\n      <input id='user_http_basic_credential_attributes_password_confirmation' name='user[http_basic_credential_attributes][password_confirmation]' type='password'>\n    </div>\n    <div class='button' id='submit'>Okay</div>\n  </form>\n</div>\n"}