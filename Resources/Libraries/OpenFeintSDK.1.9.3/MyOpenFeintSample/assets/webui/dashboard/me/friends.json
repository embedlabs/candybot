{"title":"Feint Friends","scrolling":true,"loadflow":"\nOF.GA.setAccount('UA-3107048-21','spotlight.android.openfeint.com');","init":"\n$('body').addClass('textured');$('.button').pretouch();if(!OF.menu){OF.menu=function(buttonName){if(buttonName=='home')OF.menu.home();else if(buttonName=='settings')OF.menu.settings();else if(buttonName=='exit')OF.menu.exit();else{OF.log('Unknown menu button hit: '+buttonName);}};OF.menu.home=function(){if(OF.navigationStack[0].url.match(/dashboard\\/user/)){OF.goBack({root:true});}else{OF.navigateToUrl(\"dashboard/user\",{complete:function(){OF.pages.unshift(OF.pages.pop());OF.action('back',{root:true},OF.contentLoaded);}});}};OF.menu.settings=function(){OF.sendAction('openSettings');};OF.menu.exit=function(){OF.sendAction('dismiss');};}\nif(!OF.friendsList){OF.friendsList={init:function(){jQuery.lazyLoad({threshold:0.5,nextPageLoaded:function(page,data){if(page==1){OF.friendsList.renderFriends(data);}else{OF.friendsList.addFriends(data);}},nextPageShouldLoad:function(page,callback){OF.api('/xp/friends',{params:{user_id:OF.page.user.id,page:page,page_size:50},success:function(data){callback(data.users,data.users.length<50)},failure:function(){callback([]);}});},isEmpty:function(){OF.friendsList.renderFriends([]);},isFinished:function(){jQuery(\"#loading\").hide();}});},renderFriendItems:function(friends){var html=jQuery.map(friends,function(friend){return tmpl('user_tmpl',friend);});return html;},renderFriends:function(friends){var html=OF.friendsList.renderFriendItems(friends);if(html.length>0){jQuery('#friends_list > ul').html(html.join('')).unhide();jQuery(\"#friends_list .no_data\").hide();}else{jQuery('#friends_list > ul').hide();jQuery(\"#friends_list .no_data\").unhide();}},addFriends:function(friends){var html=OF.friendsList.renderFriendItems(friends);jQuery('#friends_list > ul').append(html.join(''));}};}\n$('#home_button').touch(OF.menu.home);OF.page.user=OF.user;OF.friendsList.init();OF.shouldRefreshPage=false;OF.page.initTabs=function(){$('.tab').touch(function(){$('.tab').removeClass(\"active\");$(this).addClass(\"active\");if(this.id==\"find_friends_tab\"){$('#friends_list').hide();$('#friends_search').unhide();}else{$('#friends_search').hide();$('#friends_list').unhide();}});}\nOF.page.initTabs();OF.page.initRequest=function(){if(OF.user.received_friend_requests_pending_count>0){var reqCell=$('#requests');reqCell.unhide();reqCell.find('.title').text(OF.user.received_friend_requests_pending_count+' Friend Requests');}}\nOF.page.initRequest();OF.page.reload=function(){$(\"#friends_list > ul\").html(\"\");OF.friendsList.init();}\nOF.page.facebookDidReturn=function(retval){OF.api.request(\"/xp/facebook/link\",{method:\"POST\",params:{token:retval},complete:function(retval){OF.navigateToUrl(\"facebook/friends\");}});};OF.page.facebookDidFailtown=function(errorCode,errorDesc){OF.log('Facebook fail ('+errorCode+'), \"'+errorDesc+'\"');OF.alert(errorDesc,\"Sorry!  We can't reach Facebook right now.  Please try again later.\");};if(OF.actionIsSupported('openBrowser')){$('#facebook_search').touch(function(){OF.sendAction('openBrowser',{src:'https://graph.facebook.com/oauth/authorize?client_id=59872843319&redirect_uri=https://api.openfeint.com/fbconnect/authorized&display=touch&scope=offline_access,publish_stream',callback:'OF.page.facebookDidReturn',timeout:10000,on_failure:'OF.page.facebookDidFailtown',});});$('#facebook_search').show();}","resume":"","appear":"\n$('#header .title').html(OF.page.title);if(OF.shouldRefreshPage){OF.page.initRequest();OF.friendsList.init();OF.shouldRefreshPage=false;}","html":"<div id='dashboard'>\n<div id='header'>\n<span class='loading'>\n<span class='spinner'></span>\n</span>\n<div class='title' id='home_button'></div>\n</div>\n          <script type=\"text/plain\" id=\"user_tmpl\">\n            <%\n  var style = \"\";\n  if (user.profile_picture_url) {\n    style = \"background-image: url(\" + user.profile_picture_url + \")\";\n  }\n%>\n\n<li class=\"user\" data-href=\"dashboard/user?user_id=<%= user.id %>\">\n  <div class=\"image avatar\" style=\"<%= style %>\">\n    <div class=\"overlay\"></div>\n  </div>\n  <div class=\"title user_name\"><%= user.name %></div>\n  <div class=\"feint_score\"><%= user.gamer_score %></div>\n</li>\n          </script>\n<div id='friends'>\n<section id='tabbed_friend_navigation'>\n<ul class='tabs'>\n<li class='tab active' id='friends_tab'>\n<div class='label'>My Friends</div>\n</li>\n<li class='tab' id='find_friends_tab'>\n<div class='label'>Find Friends</div>\n</li>\n</ul>\n</section>\n<br clear='both'>\n<div class='hidden' id='friends_search'>\n<section id='find_friends'>\n<h3 class='section_title'>Find Friends!</h3>\n<div class='cell one_line' data-href='dashboard/user_search'>\n<div class='icon'></div>\n<div class='title'>Search by Feint Name</div>\n</div>\n</section>\n<section id='facebook_search' style='display: none'>\n<div class='cell one_line'>\n<div class='icon'></div>\n<div class='title'>Friends on Facebook</div>\n</div>\n</section>\n</div>\n<section id='friends_list'>\n<section class='hidden' data-href='dashboard/friend_requests' id='requests'>\n<h3 class='section_title'>Friend Requests</h3>\n<div class='cell one_line'>\n<div class='icon'></div>\n<div class='title'></div>\n</div>\n</section>\n<h3 class='section_title'>Your Friends</h3>\n<div class='cell no_data hidden'>Find friends by importing them from Facebook or adding them by their Feint name.</div>\n<ul class='cells'></ul>\n</section>\n<ul class='cells' id='loading'>\n<li class='loading'>\n<div class='spinner'></div>\n</li>\n</ul>\n</div>\n\n</div>\n"}